@model IEnumerable<DigiStoreWithMVC.Models.Store>

@if (Model.Count() > 0)
{
    <script>
        unHideBeforeSearch();
        deleteMarkers();
    </script>

    foreach (DigiStoreWithMVC.Models.Store s in Model)
    {
        DigiStoreWithMVC.Models.StoreHours today = s.StoreHours.ToList().Find(h => h.DayOfTheWeek.Equals(DateTime.Now.DayOfWeek.ToString()));
        <a href=@Url.Action("Index", "Store", new { storeName = @s.Name }) id="@s.Name">
            <li class='collection-item blue darken-3 yellow-text accent-3'>
                @s.Name | @s.Address, @s.City @s.PostalCode <br />
                @if (DateTime.Now.TimeOfDay >= today.StartTime.TimeOfDay &&
                     DateTime.Now.TimeOfDay <= today.EndTime.TimeOfDay)
                {
                    <p>Open! Today's Hours: @s.StoreHours.ToList().Find(h => h.DayOfTheWeek.Equals(DateTime.Now.DayOfWeek.ToString())).StartTime.TimeOfDay - @s.StoreHours.ToList().Find(h => h.DayOfTheWeek.Equals(DateTime.Now.DayOfWeek.ToString())).EndTime.TimeOfDay</p>
                }
                else
                {
                    <p>Closed! Today's Hours: @s.StoreHours.ToList().Find(h => h.DayOfTheWeek.Equals(DateTime.Now.DayOfWeek.ToString())).StartTime.TimeOfDay - @s.StoreHours.ToList().Find(h => h.DayOfTheWeek.Equals(DateTime.Now.DayOfWeek.ToString())).EndTime.TimeOfDay</p>
                }
            </li>
        </a>
        if (s.Address != null)
        {
            <script>
                var decodedName = $('<textarea/>').html("@s.Name").text();
                searchForAddress("@s.Address @s.City @s.PostalCode", decodedName);
            </script>
        }
    }
}
else
{
    <script>
        hideBeforeSearch();
        Materialize.toast("No stores found!", 4000, "rounded");
    </script>
}